---
phase: 04-arm-diagnostic-safety-nets
plan: "02"
type: execute
wave: 2
depends_on:
  - "01"
files_modified:
  - src/core.c
  - src/cli.c
  - src/main.c
  - tests/README.md
  - docs/USAGE.md
  - assets/tests/test_cross_arch.c
autonomous: true
requirements:
  - ARM-05
  - ARM-06
must_haves:
    truths:
      - Likely architecture mismatch signals are surfaced before destructive processing as actionable warnings.
      - ARM experimental path warnings clearly state limits and recommended fallback actions.
      - Default behavior remains warn-and-continue (no hard-fail default policy).
    artifacts:
      - path: src/core.c
        provides: Mismatch heuristic evaluation and warning trigger flow before transformation
      - path: src/cli.c
        provides: Updated architecture and experimental guidance text in help surface
      - path: src/main.c
        provides: Runtime warning emission path for mismatch and experimental guidance
    key_links:
      - from: src/main.c
        to: src/core.c
        via: Runtime processing path invokes heuristic warning checks before destructive transforms
        pattern: warning
      - from: src/cli.c
        to: src/main.c
        via: CLI architecture/experimental guidance remains consistent with runtime warning behavior
        pattern: experimental
      - from: tests/README.md
        to: docs/USAGE.md
        via: Contributor-facing diagnostics guidance aligns with usage-level fallback recommendations
        pattern: fallback
---

<objective>
Add architecture mismatch and ARM experimental diagnostics that are actionable and safe by default.

Purpose: satisfy ARM-05 and ARM-06 by warning early and guiding operators without breaking existing workflows.
Output: mismatch heuristics, warn-and-continue diagnostics path, and contributor/operator guidance updates.
</objective>

<execution_context>
@/Users/maleick/.codex/get-shit-done/workflows/execute-plan.md
@/Users/maleick/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-arm-diagnostic-safety-nets/04-CONTEXT.md
@.planning/phases/04-arm-diagnostic-safety-nets/04-RESEARCH.md
@.planning/phases/04-arm-diagnostic-safety-nets/04-01-PLAN.md
@src/core.c
@src/cli.c
@src/main.c
@tests/README.md
@docs/USAGE.md

Locked decisions to honor:
- Warn-and-continue default (no fail-by-default mismatch blocking).
- Diagnostics must be actionable and concise.
- Scope is diagnostics and guidance only, not broad auto-detection platform work.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add pre-transform architecture mismatch heuristic warnings</name>
  <files>src/core.c
src/main.c</files>
  <action>Implement likely mismatch heuristic checks before destructive processing and surface actionable warnings with reason hints and operator next steps, while preserving warn-and-continue behavior.</action>
  <verify><automated>rg -n "mismatch|architecture|warning|heuristic|continue" src/core.c src/main.c</automated></verify>
  <done>Likely architecture mismatch conditions are surfaced before destructive processing as actionable warnings.</done>
</task>

<task type="auto">
  <name>Task 2: Align ARM experimental guidance across help and runtime diagnostics</name>
  <files>src/cli.c
src/main.c
docs/USAGE.md</files>
  <action>Update ARM experimental wording to clearly describe limits and fallback recommendations, ensuring consistency between CLI help text, runtime warnings, and user-facing usage guidance.</action>
  <verify><automated>rg -n "experimental|ARM|fallback|warn|--arch|--dry-run" src/cli.c src/main.c docs/USAGE.md</automated></verify>
  <done>Experimental ARM guidance is explicit, actionable, and consistent across help/runtime/docs.</done>
</task>

<task type="auto">
  <name>Task 3: Add deterministic diagnostic validation tests and contributor triage notes</name>
  <files>assets/tests/test_cross_arch.c
tests/README.md</files>
  <action>Add focused test coverage for architecture warning behavior and update contributor documentation with diagnostic interpretation and recommended follow-up commands.</action>
  <verify><automated>rg -n "arch|mismatch|warning|diagnostic|fallback" assets/tests/test_cross_arch.c tests/README.md</automated></verify>
  <done>Diagnostic behavior is covered by deterministic tests and documented contributor triage guidance.</done>
</task>

</tasks>

<verification>
Validate that architecture mismatch and ARM experimental diagnostics appear before destructive processing, remain actionable, and preserve warn-and-continue default behavior.
</verification>

<success_criteria>
- Pre-transform mismatch heuristics emit actionable warnings
- ARM experimental diagnostics clearly describe limits and fallback paths
- Warn-and-continue default behavior is preserved
- Tests/docs provide deterministic operator guidance and evidence for ARM-05/ARM-06
</success_criteria>

<output>
After completion, create `.planning/phases/04-arm-diagnostic-safety-nets/04-02-SUMMARY.md`
</output>
