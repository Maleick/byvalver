---
phase: 06-equivalence-gate-determinism-and-triage
plan: "02"
type: execute
wave: 2
depends_on:
  - "01"
files_modified:
  - tests/run_tests.sh
  - .github/workflows/release-gate.yml
  - docs/RELEASE.md
autonomous: true
requirements:
  - REL-05
must_haves:
    truths:
      - Release-gate failures identify the exact failing tuple (architecture, fixture, check) without manual log archaeology.
      - Every failed required tuple includes deterministic local rerun guidance.
      - CI release-gate summary and artifacts expose the same tuple semantics as local runner output.
    artifacts:
      - path: tests/run_tests.sh
        provides: Tuple-aware summary generation with rerun command fields for failed checks
      - path: .github/workflows/release-gate.yml
        provides: CI presentation of tuple failures and artifact references
      - path: docs/RELEASE.md
        provides: Operator triage runbook keyed by tuple outputs and rerun commands
    key_links:
      - from: .github/workflows/release-gate.yml
        to: tests/run_tests.sh
        via: Workflow summary consumes runner-generated tuple artifacts for release diagnostics
        pattern: parity-compare
      - from: docs/RELEASE.md
        to: .github/workflows/release-gate.yml
        via: Release checklist references CI tuple summary and artifact review requirements
        pattern: release-gate
      - from: docs/RELEASE.md
        to: tests/run_tests.sh
        via: Documentation maps each failing tuple class to canonical local rerun commands
        pattern: rerun
---

<objective>
Make release-gate failure artifacts immediately actionable.

Purpose: satisfy REL-05 by standardizing failing tuple output and deterministic rerun guidance across local and CI surfaces.
Output: stable release-gate tuple schema, CI summary integration, and operator triage documentation.
</objective>

<execution_context>
@/Users/maleick/.codex/get-shit-done/workflows/execute-plan.md
@/Users/maleick/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/06-equivalence-gate-determinism-and-triage/06-RESEARCH.md
@.planning/phases/06-equivalence-gate-determinism-and-triage/06-01-PLAN.md
@tests/run_tests.sh
@.github/workflows/release-gate.yml
@docs/RELEASE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend runner summaries with deterministic rerun metadata for failing tuples</name>
  <files>tests/run_tests.sh</files>
  <action>Augment equivalence/parity summary payloads so each failed required tuple includes deterministic rerun command metadata and normalized failure classification fields.</action>
  <verify><automated>bash tests/run_tests.sh --mode verify-parity --arch all --artifacts-dir ci-artifacts/phase6-rerun-meta</automated></verify>
  <done>Failed required tuples in summary outputs include stable rerun metadata and failure classification for machine and human consumers.</done>
</task>

<task type="auto">
  <name>Task 2: Surface tuple failures in release workflow step summary</name>
  <files>.github/workflows/release-gate.yml</files>
  <action>Update release-gate workflow summary generation to render failing tuple rows and artifact pointers directly in CI step summary output while preserving fail-closed behavior.</action>
  <verify><automated>rg -n "Release Gate Parity Summary|tuple|artifact|mismatch|workflow_dispatch" .github/workflows/release-gate.yml</automated></verify>
  <done>CI release-gate summary presents deterministic failing tuple diagnostics without additional log parsing.
</done>
</task>

<task type="auto">
  <name>Task 3: Document tuple-based triage workflow and rerun matrix</name>
  <files>docs/RELEASE.md</files>
  <action>Publish a tuple-oriented triage section that maps failure class to canonical local rerun commands and artifact inspection sequence.</action>
  <verify><automated>rg -n "tuple|rerun|release-gate|artifact|verify-equivalence" docs/RELEASE.md</automated></verify>
  <done>Release docs provide a deterministic path from failing tuple to reproducible local diagnosis.
</done>
</task>

</tasks>

<verification>
Validate that release-gate surfaces exact failing tuples with deterministic rerun guidance in both runner artifacts and CI summaries.
</verification>

<success_criteria>
- Failing required tuples include rerun metadata in machine-readable summaries
- CI release-gate summary exposes tuple diagnostics and artifact links
- Release runbook documents tuple-based triage and rerun sequence
</success_criteria>

<output>
After completion, create `.planning/phases/06-equivalence-gate-determinism-and-triage/06-02-SUMMARY.md`
</output>
