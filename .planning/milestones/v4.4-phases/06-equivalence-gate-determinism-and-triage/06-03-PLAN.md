---
phase: 06-equivalence-gate-determinism-and-triage
plan: "03"
type: execute
wave: 3
depends_on:
  - "01"
  - "02"
files_modified:
  - tests/run_tests.sh
  - verify_functionality.py
  - verify_semantic.py
  - .github/workflows/release-gate.yml
  - Makefile
  - docs/BUILD.md
autonomous: true
requirements:
  - REL-04
  - REL-06
must_haves:
    truths:
      - Representative equivalence checks are deterministic and no longer blocked by known harness-level instability paths.
      - Local and CI release-gate paths evaluate the same required check set with identical pass/fail semantics.
      - Release-gate parity decisions are reproducible across host and Docker with shared required-check policy.
    artifacts:
      - path: tests/run_tests.sh
        provides: Unified required-check policy and deterministic release-gate decision logic
      - path: verify_functionality.py
        provides: Architecture-aware functionality verification behavior aligned with phase-6 determinism goals
      - path: verify_semantic.py
        provides: Stable semantic verification behavior for representative release-gate fixtures
      - path: .github/workflows/release-gate.yml
        provides: CI gate invocation aligned to unified required-check policy
      - path: Makefile
        provides: Local release-gate command path using same required-check semantics
    key_links:
      - from: tests/run_tests.sh
        to: verify_functionality.py
        via: Runner invokes architecture-appropriate functionality checks as required gate inputs
        pattern: verify_functionality.py
      - from: tests/run_tests.sh
        to: verify_semantic.py
        via: Runner semantic check invocation is normalized into required-check decision logic
        pattern: verify_semantic.py
      - from: Makefile
        to: .github/workflows/release-gate.yml
        via: Local and CI release-gate entry points share equivalent required-check contract
        pattern: release-gate
      - from: docs/BUILD.md
        to: Makefile
        via: Build docs point to canonical local gate command with parity expectations
        pattern: make release-gate
---

<objective>
Resolve known representative equivalence blocker paths and lock local/CI required-check parity semantics.

Purpose: complete REL-04 and REL-06 by eliminating harness-level instability and enforcing one required-check contract across release execution surfaces.
Output: deterministic representative gate behavior and local/CI release-gate policy equivalence.
</objective>

<execution_context>
@/Users/maleick/.codex/get-shit-done/workflows/execute-plan.md
@/Users/maleick/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/06-equivalence-gate-determinism-and-triage/06-RESEARCH.md
@.planning/phases/06-equivalence-gate-determinism-and-triage/06-01-PLAN.md
@.planning/phases/06-equivalence-gate-determinism-and-triage/06-02-PLAN.md
@tests/run_tests.sh
@verify_functionality.py
@verify_semantic.py
@.github/workflows/release-gate.yml
@Makefile
@docs/BUILD.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove harness-level instability sources in representative equivalence verification</name>
  <files>tests/run_tests.sh
verify_functionality.py
verify_semantic.py</files>
  <action>Implement targeted fixes for known representative equivalence instability paths (architecture handling, invocation normalization, and deterministic status mapping) so repeated runs on the same fixture tuple yield consistent outcomes.</action>
  <verify><automated>bash tests/run_tests.sh --mode verify-equivalence --arch all --artifacts-dir ci-artifacts/phase6-stability</automated></verify>
  <done>Representative equivalence checks execute with stable architecture-aware behavior and deterministic tuple statuses across repeated runs.
</done>
</task>

<task type="auto">
  <name>Task 2: Unify required-check policy between local and CI release-gate entry points</name>
  <files>tests/run_tests.sh
.github/workflows/release-gate.yml
Makefile</files>
  <action>Define one required-check contract in the runner and ensure both `make release-gate` and workflow execution consume that contract without divergence in pass/fail semantics.</action>
  <verify><automated>make release-gate</automated></verify>
  <done>Local and CI release-gate paths use the same required checks and produce equivalent gate decisions for identical inputs.
</done>
</task>

<task type="auto">
  <name>Task 3: Document finalized phase-6 gate policy and reproducibility expectations</name>
  <files>docs/BUILD.md</files>
  <action>Update build/release guidance to describe final phase-6 release-gate policy, required-check parity expectations, and deterministic artifact interpretation contract.</action>
  <verify><automated>rg -n "release-gate|required check|deterministic|parity" docs/BUILD.md</automated></verify>
  <done>Build docs reflect the final deterministic required-check contract shared by local and CI release flows.
</done>
</task>

</tasks>

<verification>
Validate that representative equivalence checks run deterministically and that local + CI release-gate entry points enforce the same required-check contract.
</verification>

<success_criteria>
- Known representative equivalence harness instability paths are remediated
- `make release-gate` and CI release gate share identical required-check semantics
- Phase-6 gate policy is documented for maintainers and contributors
</success_criteria>

<output>
After completion, create `.planning/phases/06-equivalence-gate-determinism-and-triage/06-03-SUMMARY.md`
</output>
