---
phase: 01-ci-foundation-and-fixture-canonicalization
plan: "03"
type: execute
wave: 3
depends_on:
  - "02"
files_modified:
  - Makefile
  - tests/run_tests.sh
  - docs/CONTRIBUTOR_BASELINE.md
  - tests/README.md
  - docs/BUILD.md
  - README.md
autonomous: true
requirements:
  - REL-02
  - TEST-01
must_haves:
    truths:
      - Contributors can run one documented command to replicate CI baseline checks locally.
      - Local baseline output is concise by default, with optional verbose detail.
      - Local baseline performs preflight checks and surfaces actionable dependency hints.
    artifacts:
      - path: Makefile
        provides: Single canonical local baseline target
      - path: tests/run_tests.sh
        provides: Preflight hints and concise/verbose output controls
      - path: docs/CONTRIBUTOR_BASELINE.md
        provides: Contributor runbook for CI-parity baseline execution
    key_links:
      - from: Makefile
        to: tests/run_tests.sh
        via: ci-baseline target runs baseline-mode test runner
        pattern: tests/run_tests.sh --mode baseline --arch all
      - from: docs/CONTRIBUTOR_BASELINE.md
        to: Makefile
        via: runbook references canonical command path
        pattern: make ci-baseline
---

<objective>
Publish the single-command local baseline workflow and align contributor docs with CI baseline behavior.

Purpose: satisfy REL-02 and lock local/CI parity for phase 1.
Output: one Make target, improved baseline runner UX, and updated contributor documentation.
</objective>

<execution_context>
@/Users/maleick/.codex/get-shit-done/workflows/execute-plan.md
@/Users/maleick/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-ci-foundation-and-fixture-canonicalization/01-CONTEXT.md
@.planning/phases/01-ci-foundation-and-fixture-canonicalization/01-RESEARCH.md
@.planning/phases/01-ci-foundation-and-fixture-canonicalization/01-02-PLAN.md
@Makefile
@tests/run_tests.sh
@README.md
@tests/README.md
@docs/BUILD.md

Locked decisions to honor:
- canonical local baseline entry is one Make target
- default output concise, optional verbose mode
- preflight checks print actionable install hints
- local baseline mirrors CI baseline checks and gates
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add canonical local baseline Make target</name>
  <files>Makefile</files>
  <action>Add `ci-baseline` as the canonical contributor entry point. It must run dependency preflight (`make check-deps`), build (`make`), and baseline verification (`bash tests/run_tests.sh --mode baseline --arch all`). Support optional verbose execution via `VERBOSE=1` and pass that mode through to the runner so local output can be concise by default.</action>
  <verify><automated>rg -n "^ci-baseline:" Makefile && rg -n "check-deps|tests/run_tests\\.sh --mode baseline --arch all|VERBOSE" Makefile</automated></verify>
  <done>One make target can execute the same baseline gate sequence as CI with optional verbose detail.</done>
</task>

<task type="auto">
  <name>Task 2: Implement preflight hints and concise/verbose output behavior</name>
  <files>tests/run_tests.sh</files>
  <action>Update runner UX to default to concise summaries while preserving a verbose mode for troubleshooting. Add explicit preflight dependency checks with actionable install hints before expensive build/test steps. Keep gate semantics identical to CI baseline mode so local and CI pass/fail logic stay aligned.</action>
  <verify><automated>bash -n tests/run_tests.sh && rg -n "preflight|install hint|verbose|concise|--mode baseline" tests/run_tests.sh</automated></verify>
  <done>Runner provides deterministic gate behavior and useful operator feedback without noisy default output.</done>
</task>

<task type="auto">
  <name>Task 3: Publish and link contributor baseline runbook</name>
  <files>docs/CONTRIBUTOR_BASELINE.md
README.md
tests/README.md
docs/BUILD.md</files>
  <action>Create `docs/CONTRIBUTOR_BASELINE.md` describing the canonical command path, expected outputs, and troubleshooting flow. Update README, tests README, and build docs to link to this runbook and explicitly call out `make ci-baseline` as the one-command CI parity path.</action>
  <verify><automated>rg -n "make ci-baseline|CONTRIBUTOR_BASELINE" docs/CONTRIBUTOR_BASELINE.md README.md tests/README.md docs/BUILD.md</automated></verify>
  <done>Contributor docs converge on one baseline command and clearly describe CI parity expectations.</done>
</task>

</tasks>

<verification>
Run documentation and target wiring checks to confirm all contributor entry points converge on `make ci-baseline`.
</verification>

<success_criteria>
- `Makefile` has `ci-baseline` target with dependency/build/test chaining
- Runner supports concise default and verbose mode with preflight hints
- New contributor runbook exists and is linked from primary docs
- Local baseline path is explicitly documented as CI-parity
</success_criteria>

<output>
After completion, create `.planning/phases/01-ci-foundation-and-fixture-canonicalization/01-03-SUMMARY.md`
</output>
