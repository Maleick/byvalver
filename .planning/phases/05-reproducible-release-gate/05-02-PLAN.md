---
phase: 05-reproducible-release-gate
plan: "02"
type: execute
wave: 2
depends_on:
  - "01"
files_modified:
  - .github/workflows/release-gate.yml
  - Makefile
  - tests/run_tests.sh
  - docs/RELEASE.md
  - README.md
autonomous: true
requirements:
  - REL-03
must_haves:
    truths:
      - Release-gate checks run on version-tag pushes and via workflow_dispatch dry-run path.
      - Tag publication is blocked when required bad-byte/equivalence parity checks fail.
      - Maintainers can run one local command path that mirrors CI release gate behavior.
    artifacts:
      - path: .github/workflows/release-gate.yml
        provides: Enforced release-gate workflow for tag and manual trigger paths
      - path: tests/run_tests.sh
        provides: Gate execution primitives shared by CI and local preflight paths
      - path: Makefile
        provides: Canonical local release-gate command entry point
      - path: docs/RELEASE.md
        provides: Formal release checklist and gate interpretation guidance
    key_links:
      - from: .github/workflows/release-gate.yml
        to: tests/run_tests.sh
        via: Workflow invokes release-gate checks and fails closed on mismatches
        pattern: verify-parity
      - from: Makefile
        to: tests/run_tests.sh
        via: Local release command mirrors CI gate command path
        pattern: release-gate
      - from: docs/RELEASE.md
        to: .github/workflows/release-gate.yml
        via: Checklist requires successful workflow status and artifact review before tagging
        pattern: workflow_dispatch
---

<objective>
Enforce a formal release checklist and hard gate checks before tag publication.

Purpose: satisfy REL-03 by preventing unverifiable releases and providing a mirrored local preflight path.
Output: release workflow gate, local command mirror, and release checklist documentation.
</objective>

<execution_context>
@/Users/maleick/.codex/get-shit-done/workflows/execute-plan.md
@/Users/maleick/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/05-reproducible-release-gate/05-CONTEXT.md
@.planning/phases/05-reproducible-release-gate/05-RESEARCH.md
@.planning/phases/05-reproducible-release-gate/05-01-PLAN.md
@.github/workflows/ci.yml
@Makefile
@tests/run_tests.sh
@README.md

Locked decisions to honor:
- Gate enforcement is CI plus mirrored local command path.
- CI trigger model includes version tags and workflow_dispatch.
- Required parity mismatches are hard-fail gate conditions.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add dedicated release-gate workflow with strict fail policy</name>
  <files>.github/workflows/release-gate.yml
tests/run_tests.sh</files>
  <action>Create a release-gate workflow triggered by version tags and workflow_dispatch that runs required gate checks (including parity) and fails closed on any required mismatch, publishing artifact references for diagnosis.</action>
  <verify><automated>rg -n "workflow_dispatch|tags:|verify-parity|fail" .github/workflows/release-gate.yml tests/run_tests.sh</automated></verify>
  <done>Release workflow enforces required gate checks for tag/manual runs and blocks on parity or verification failures.</done>
</task>

<task type="auto">
  <name>Task 2: Add canonical local release-gate command that mirrors CI</name>
  <files>Makefile
tests/run_tests.sh</files>
  <action>Add one canonical local release-gate entry point that executes the same required checks used by CI release-gate flow, with clear non-zero failure semantics for pre-tag use.</action>
  <verify><automated>make release-gate</automated></verify>
  <done>Maintainers can run one local command that mirrors CI release gate behavior and failure conditions.</done>
</task>

<task type="auto">
  <name>Task 3: Publish release checklist and routing documentation</name>
  <files>docs/RELEASE.md
README.md</files>
  <action>Document a release checklist that requires successful gate run, artifact review, and explicit triage steps for parity mismatches, then link the checklist from top-level docs.</action>
  <verify><automated>rg -n "release-gate|workflow_dispatch|tag|checklist|verify-parity" docs/RELEASE.md README.md</automated></verify>
  <done>Release checklist is explicit, enforceable, and discoverable from repository entry docs.</done>
</task>

</tasks>

<verification>
Validate that release process is blocked unless required checks succeed in tag/manual gate runs and that maintainers have a local mirrored preflight command and checklist.
</verification>

<success_criteria>
- Version-tag and workflow_dispatch release gate paths are defined
- Required gate failures block release progression
- Local `make release-gate` mirrors CI gate scope
- Release checklist documents mandatory pre-tag evidence and triage flow
</success_criteria>

<output>
After completion, create `.planning/phases/05-reproducible-release-gate/05-02-SUMMARY.md`
</output>
