services:
  # Development build environment
  byvalver-dev:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - ./src:/opt/byvalver/src:ro
      - ./ml_models:/opt/byvalver/ml_models:ro
      - ./input:/data/input
      - ./output:/data/output
    working_dir: /opt/byvalver
    entrypoint: ["./bin/byvalver"]

  # Run verification suite
  verify:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - ./tests/fixtures:/data/fixtures:ro
      - ./verify_denulled.py:/opt/byvalver/verify_denulled.py:ro
      - ./verify_functionality.py:/opt/byvalver/verify_functionality.py:ro
      - ./verify_semantic.py:/opt/byvalver/verify_semantic.py:ro
    entrypoint: ["python3"]
    command: ["verify_denulled.py", "--batch", "/data/fixtures"]
